<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEXUS-7</title>
  <style>
    :root {
      --bg: #000;
      --text: #0f0;
      --accent: #0f0;
      --card: #111;
      --border: #0f0;
      --error: #f55;
      --glow: 0 0 10px rgba(0,255,0,0.6);
    }
    [data-theme="matrix"] {
      --text: #0f0;
      --accent: #0f0;
      --bg: #000;
      --card: #111;
      --border: #0f0;
    }
    [data-theme="retro"] {
      --text: #ff0;
      --accent: #ff0;
      --bg: #001;
      --card: #113;
      --border: #ff0;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Courier New', monospace;
      font-weight: bold;
      line-height: 1.6;
      padding: 12px;
      overflow: hidden;
      position: relative;
      min-height: 100vh;
      transition: all 0.4s;
    }

    /* Boot */
    #bootScreen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #000; color: #0f0; display: flex; flex-direction: column;
      justify-content: center; align-items: center; z-index: 999999;
      font-size: 1.2rem; text-align: center;
    }
    .scanline { height: 2px; background: #0f0; width: 0; animation: scanline 2s linear infinite; }
    @keyframes scanline { to { width: 100%; } }

    /* Scanlines */
    .crt::before {
      content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: repeating-linear-gradient(0deg, rgba(0,0,0,0.15), rgba(0,0,0,0.15) 1px, transparent 1px, transparent 2px);
      pointer-events: none; z-index: 9999; opacity: 0; transition: opacity 0.5s;
    }
    .crt.active::before { opacity: 0.3; animation: scan 10s linear infinite; }
    @keyframes scan { 0% { transform: translateY(-100%); } 100% { transform: translateY(100%); } }

    .glow { text-shadow: var(--glow); }

    /* Layout */
    .wrapper { max-width: 1000px; margin: 0 auto; display: flex; flex-direction: column; gap: 8px; }
    .container { background: var(--card); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; box-shadow: var(--glow); }

    .header { padding: 14px; background: #000; color: var(--text); text-align: center; font-size: 1.3rem; border-bottom: 1px solid var(--border); }

    .input-bar { padding: 12px; display: flex; gap: 8px; background: #000; flex-wrap: wrap; }
    input { flex: 1; min-width: 200px; padding: 10px; background: #000; color: var(--text); border: 1px solid var(--border); border-radius: 4px; }
    input::placeholder { color: #0a0; }
    button { padding: 8px 12px; background: transparent; color: var(--text); border: 1px solid var(--border); border-radius: 4px; cursor: pointer; font-size: 0.8rem; white-space: nowrap; }
    button:hover { background: var(--accent); color: #000; box-shadow: var(--glow); }

    .viewer { width: 100%; height: 580px; border: 1px solid var(--border); border-top: none; transition: all 0.3s; }
    .viewer.fs { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 99999; border: none; border-radius: 0; }

    .info { padding: 8px; font-size: 0.75rem; color: #0a0; text-align: center; background: #000; border-top: 1px solid var(--border); }

    .favorites, .game-grid { padding: 8px; display: flex; gap: 6px; flex-wrap: wrap; background: #000; max-height: 120px; overflow-y: auto; }
    .fav-btn, .game-btn { padding: 6px 10px; background: transparent; color: #0a0; border: 1px dashed #0a0; border-radius: 4px; font-size: 0.7rem; cursor: pointer; }
    .fav-btn:hover, .game-btn:hover { border: 1px solid var(--accent); color: var(--accent); }

    /* Visualizer */
    .visualizer { height: 60px; background: #000; display: flex; align-items: end; gap: 2px; padding: 0 8px; border-top: 1px solid var(--border); }
    .bar { width: 4px; background: var(--accent); transition: height 0.05s; }

    /* Control Bar */
    .control-bar {
      position: fixed; top: 16px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px; z-index: 1001; background: #000; padding: 6px; border: 1px solid var(--border); border-radius: 8px;
      flex-wrap: wrap; justify-content: center;
    }

    /* UNHIDE */
    #unhideBtn {
      position: fixed; top: 16px; right: 16px; background: #f55; color: #000; width: 40px; height: 40px;
      border-radius: 50%; font-size: 20px; cursor: pointer; z-index: 99998; display: none; animation: pulse 2s infinite;
    }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }

    /* DRAGGABLE PANELS */
    .panel {
      position: fixed; width: 300px; background: #000; color: var(--text);
      padding: 20px; z-index: 999; border: 1px solid var(--border);
      box-shadow: 0 0 20px rgba(0,255,0,0.3); overflow-y: auto;
      user-select: none; cursor: move;
      transition: none;
    }
    .panel-header {
      cursor: grab; padding: 8px; background: #111; border-bottom: 1px solid var(--border); margin: -20px -20px 16px -20px; text-align: center; font-weight: bold;
    }
    .panel-header:active { cursor: grabbing; }
    .commands-panel { top: 100px; left: 50px; }
    .settings-panel { top: 100px; right: 50px; }
    .close-btn { float: right; font-size: 24px; cursor: pointer; color: #0a0; }

    /* Console */
    .console {
      position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.95); color: var(--text);
      padding: 10px; font-size: 0.8rem; border-top: 1px solid var(--border);
      z-index: 1000; display: none; max-height: 300px; overflow-y: auto;
    }
    .console.open { display: block; }
    .console-input { width: 100%; background: #000; color: var(--text); border: none; outline: none; }

    /* Stealth */
    .stealth .input-bar, .stealth .favorites, .stealth .game-grid, .stealth .info, .stealth .header, .stealth .visualizer { display: none !important; }
    .stealth .viewer { height: 100vh; border: none; }
    .stealth .control-bar { top: 8px; padding: 4px; font-size: 0.7rem; }
    .stealth #unhideBtn { display: block !important; }

    /* Password */
    #passwordOverlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #000; color: var(--text); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 99999;
      font-size: 1.2rem; text-align: center;
    }
  </style>
</head>
<body class="crt" data-theme="hacker">
  <!-- Boot -->
  <div id="bootScreen">
    <div class="glow">NEXUS-7 v6.5</div>
    <div>BOOTING...</div>
    <div class="scanline"></div>
  </div>

  <!-- Password -->
  <div id="passwordOverlay" style="display:none;">
    <div class="glow">SECURE ACCESS</div>
    <input type="password" id="passwordInput" placeholder="PASSPHRASE" />
    <button onclick="checkPassword()">UNLOCK</button>
    <div style="font-size:0.8rem; color:#0a0; margin-top:10px;">nexus7</div>
  </div>

  <!-- UNHIDE -->
  <div id="unhideBtn" onclick="exitStealth()">Warning</div>

  <!-- Control Bar -->
  <div class="control-bar" id="controlBar" style="display:none;">
    <button onclick="enterFullscreen()">FS</button>
    <button onclick="exitFullscreen()">EXIT FS</button>
    <button onclick="toggleConsole()">CONSOLE</button>
    <button onclick="toggleCommands()">CMD</button>
    <button onclick="toggleSettings()">SETTINGS</button>
    <button onclick="toggleStealth()">STEALTH</button>
    <button onclick="toggleProxy()">PROXY</button>
    <button onclick="toggleSound()">SOUND</button>
    <button onclick="cycleTheme()">THEME</button>
    <button onclick="saveFavorite()">SAVE</button>
    <button onclick="clearConsole()">CLEAR</button>
  </div>

  <div class="wrapper" id="mainUI" style="display:none;">
    <div class="container">
      <div class="header">NEXUS-7 // v6.5</div>
      
      <div class="input-bar">
        <input type="text" id="urlInput" placeholder="> TARGET: " />
        <button onclick="loadSite()">EXECUTE</button>
        <button onclick="openInTab()">TAB</button>
      </div>

      <div class="favorites" id="favoritesBar"></div>
      <div class="game-grid" id="gameGrid"></div>

      <iframe id="siteFrame" class="viewer"></iframe>

      <div class="visualizer" id="visualizer"></div>

      <div class="info">
        DRAG PANELS • THEME CYCLES • STEALTH = FULL HIDE
      </div>
    </div>
  </div>

  <!-- Console -->
  <div class="console" id="console">
    <div id="consoleOutput"></div>
    <input type="text" class="console-input" id="consoleInput" placeholder="> " />
  </div>

  <!-- Draggable CMD Panel -->
  <div class="panel commands-panel" id="commands" style="display:none;">
    <div class="panel-header" onmousedown="dragStart(event, this.parentElement)">COMMANDS</div>
    <div class="close-btn" onclick="toggleCommands()">X</div>
    <div style="margin:10px 0; padding:8px; border:1px dashed #0a0; border-radius:4px; cursor:pointer;" onclick="executeCmd('clear')"><span style="color:var(--accent)">clear</span></div>
    <div style="margin:10px 0; padding:8px; border:1px dashed #0a0; border-radius:4px; cursor:pointer;" onclick="executeCmd('proxy')"><span style="color:var(--accent)">proxy</span></div>
    <div style="margin:10px 0; padding:8px; border:1px dashed #0a0; border-radius:4px; cursor:pointer;" onclick="executeCmd('stealth')"><span style="color:var(--accent)">stealth</span></div>
  </div>

  <!-- Draggable Settings Panel -->
  <div class="panel settings-panel" id="settings" style="display:none;">
    <div class="panel-header" onmousedown="dragStart(event, this.parentElement)">SETTINGS</div>
    <div class="close-btn" onclick="toggleSettings()">X</div>
    <label><input type="checkbox" id="autoFull"> Auto FS</label><br><br>
    <label><input type="checkbox" id="scanlines" onchange="toggleScanlines()" checked> Scanlines</label><br><br>
    <label><input type="checkbox" id="visualizerOn" onchange="toggleVisualizer()" checked> Visualizer</label><br><br>
    <label><input type="checkbox" id="soundMode" onchange="toggleSound()"> Sound</label>
  </div>

  <script>
    const frame = document.getElementById('siteFrame');
    const input = document.getElementById('urlInput');
    const consoleOutput = document.getElementById('consoleOutput');
    const consoleInput = document.getElementById('consoleInput');
    const mainUI = document.getElementById('mainUI');
    const overlay = document.getElementById('passwordOverlay');
    const controlBar = document.getElementById('controlBar');
    const unhideBtn = document.getElementById('unhideBtn');
    const visualizer = document.getElementById('visualizer');
    let audioCtx, analyser, source, dataArray, bars = [];
    let useProxy = false;
    let proxyIndex = 0;
    const proxies = ['https://api.codetabs.com/v1/proxy?quest=', 'https://api.allorigins.win/raw?url=', 'https://thingproxy.freeboard.io/fetch/'];
    let soundEnabled = false;
    let favorites = JSON.parse(localStorage.getItem('nexusFavs') || '[]');
    let currentTheme = 'hacker';

    // DRAG PANELS
    function dragStart(e, panel) {
      if (e.target !== e.currentTarget) return;
      let shiftX = e.clientX - panel.getBoundingClientRect().left;
      let shiftY = e.clientY - panel.getBoundingClientRect().top;

      function move(e) {
        panel.style.left = (e.clientX - shiftX) + 'px';
        panel.style.top = (e.clientY - shiftY) + 'px';
        panel.style.right = 'auto';
      }

      document.addEventListener('mousemove', move);
      document.addEventListener('mouseup', () => {
        document.removeEventListener('mousemove', move);
      }, { once: true });
    }

    // THEME CYCLE
    function cycleTheme() {
      const themes = ['hacker', 'matrix', 'retro'];
      const idx = themes.indexOf(currentTheme);
      currentTheme = themes[(idx + 1) % themes.length];
      document.body.setAttribute('data-theme', currentTheme);
      log(`THEME: ${currentTheme.toUpperCase()}`);
      beep(1000, 100);
    }

    // Visualizer
    function initVisualizer() {
      if (!document.getElementById('visualizerOn').checked) return;
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioCtx.createAnalyser();
      analyser.fftSize = 64;
      dataArray = new Uint8Array(analyser.frequencyBinCount);
      for (let i = 0; i < 32; i++) {
        const bar = document.createElement('div');
        bar.className = 'bar';
        bar.style.height = '2px';
        visualizer.appendChild(bar);
        bars.push(bar);
      }
    }
    function updateVisualizer() {
      if (!document.getElementById('visualizerOn').checked || !analyser) return requestAnimationFrame(updateVisualizer);
      analyser.getByteFrequencyData(dataArray);
      bars.forEach((bar, i) => {
        bar.style.height = (dataArray[i] / 255 * 60) + 'px';
      });
      requestAnimationFrame(updateVisualizer);
    }
    function toggleVisualizer() {
      const on = document.getElementById('visualizerOn').checked;
      visualizer.style.display = on ? 'flex' : 'none';
      if (on && !analyser) initVisualizer();
      if (on) updateVisualizer();
    }

    // Beep
    function beep(freq = 800, dur = 100) {
      if (!soundEnabled) return;
      const ctx = new AudioContext();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain); gain.connect(ctx.destination);
      osc.frequency.value = freq;
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + dur/1000);
      osc.start(); osc.stop(ctx.currentTime + dur/1000);
    }

    // Log
    function log(msg, type = 'info') {
      const div = document.createElement('div');
      div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
      consoleOutput.appendChild(div);
      consoleOutput.scrollTop = consoleOutput.scrollHeight;
      beep(800, 80);
    }

    // Boot
    setTimeout(() => {
      document.getElementById('bootScreen').style.display = 'none';
      overlay.style.display = 'flex';
    }, 2500);

    // Unlock
    function checkPassword() {
      if (document.getElementById('passwordInput').value === 'nexus7') {
        overlay.style.display = 'none';
        mainUI.style.display = 'block';
        controlBar.style.display = 'flex';
        log('ACCESS GRANTED');
        initGames();
        loadFavorites();
        toggleScanlines();
        toggleVisualizer();
      } else {
        log('ACCESS DENIED', 'error');
      }
    }

    // Fullscreen
    function enterFullscreen() { frame.classList.add('fs'); frame.requestFullscreen(); beep(1000, 150); }
    function exitFullscreen() { if (document.fullscreenElement) document.exitFullscreen(); frame.classList.remove('fs'); beep(600, 100); }

    // Stealth
    function toggleStealth() {
      document.body.classList.toggle('stealth');
      unhideBtn.style.display = document.body.classList.contains('stealth') ? 'block' : 'none';
      log('STEALTH: ' + (document.body.classList.contains('stealth') ? 'ON' : 'OFF'));
    }
    function exitStealth() {
      document.body.classList.remove('stealth');
      unhideBtn.style.display = 'none';
      log('UI RESTORED');
    }

    // Load Site
    function loadSite() {
      let url = input.value.trim();
      if (!url) return log('NO TARGET');
      if (!url.startsWith('http')) url = 'https://' + url;
      if (useProxy) url = proxies[proxyIndex] + encodeURIComponent(url);
      frame.src = url;
      log(`LOAD: ${url}`);
      if (document.getElementById('autoFull').checked) setTimeout(enterFullscreen, 800);
    }

    function openInTab() {
      let url = input.value.trim();
      if (!url) return;
      if (!url.startsWith('http')) url = 'https://' + url;
      window.open(useProxy ? proxies[proxyIndex] + encodeURIComponent(url) : url, '_blank');
      log(`TAB: ${url}`);
    }

    // Proxy
    function toggleProxy() {
      proxyIndex = (proxyIndex + 1) % proxies.length;
      useProxy = true;
      log(`PROXY: ${proxyIndex + 1}`);
    }

    // Sound
    function toggleSound() {
      soundEnabled = !soundEnabled;
      log(`SOUND: ${soundEnabled ? 'ON' : 'OFF'}`);
    }

    // Favorites
    function saveFavorite() {
      const url = input.value.trim();
      if (!url || favorites.includes(url)) return;
      favorites.unshift(url);
      if (favorites.length > 10) favorites.pop();
      localStorage.setItem('nexusFavs', JSON.stringify(favorites));
      loadFavorites();
      log(`SAVED: ${url}`);
    }
    function loadFavorites() {
      const bar = document.getElementById('favoritesBar');
      bar.innerHTML = '';
      favorites.forEach(url => {
        const btn = document.createElement('div');
        btn.className = 'fav-btn';
        btn.textContent = url.split('/')[2] || 'link';
        btn.onclick = () => { input.value = url; loadSite(); };
        bar.appendChild(btn);
      });
    }

    // Games
    function initGames() {
      const games = [
        {name: 'Slope', url: 'https://slope-game.github.io/'},
        {name: 'Krunker', url: 'https://krunker.io'},
        {name: '1v1.LOL', url: 'https://1v1.lol'},
      ];
      const grid = document.getElementById('gameGrid');
      games.forEach(g => {
        const btn = document.createElement('div');
        btn.className = 'game-btn';
        btn.textContent = g.name;
        btn.onclick = () => { input.value = g.url; loadSite(); };
        grid.appendChild(btn);
      });
    }

    // Scanlines
    function toggleScanlines() {
      const enabled = document.getElementById('scanlines').checked;
      document.body.classList.toggle('active', enabled);
    }

    // Console
    function toggleConsole() { document.getElementById('console').classList.toggle('open'); }
    consoleInput.addEventListener('keypress', e => {
      if (e.key === 'Enter') {
        const cmd = consoleInput.value.trim();
        log(`> ${cmd}`);
        if (cmd === 'clear') { consoleOutput.innerHTML = ''; }
        consoleInput.value = '';
      }
    });

    // Panels
    function toggleCommands() { document.getElementById('commands').style.display = document.getElementById('commands').style.display === 'block' ? 'none' : 'block'; }
    function toggleSettings() { document.getElementById('settings').style.display = document.getElementById('settings').style.display === 'block' ? 'none' : 'block'; }

    function clearConsole() { consoleOutput.innerHTML = ''; log('CLEARED'); }

    // Double-click
    frame.addEventListener('dblclick', enterFullscreen);

    // Init
    document.getElementById('passwordInput').focus();
  </script>
</body>
</html>
